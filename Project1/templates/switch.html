{% extends "base.html" %}
{% block content %}

<!-- Info Banner -->
<div class="bg-blue-600 text-white py-4 mb-4 rounded-lg">
    <div class="container mx-auto px-4">
        <h1 class="text-2xl font-semibold">Switch: {{ switch.hostname }}</h1> <!-- Using switch.hostname -->
        <p class="text-sm">Details and interfaces for this switch are shown below.</p>
        <p class="text-sm">Click on an interface to view more details.</p>
    </div>
</div>

<!-- Switch Information -->
<div  class="block bg-gray-900 dark:bg-gray-800 p-6 rounded-lg shadow hover:bg-gray-800 dark:hover:bg-gray-700">
    <div class="flex items-center space-x-6">
        <i class="fa-solid fa-network-wired text-blue-500 text-5xl"></i>
        <div class="text-left">
            <div class="text-2xl font-semibold text-white">{{ switch.hostname or 'Problems?'}}</div>
            <div class="text-lg text-gray-400">{{ switch.ip_address or 'Not available' }}</div>
            <div class="text-lg text-gray-400">{{ switch.location or 'Unknown' }}</div>
        </div>
    </div>


<!-- Display stack groups -->
<div class="flex flex-col gap-y-4 mt-4">
    {% for stack, groups in stack_groups.items() %}
        <div class="flex flex-col items-start mb-4">
            <h4 class="text-lg font-semibold text-white">{{ stack }}</h4>
            <div class="flex space-x-1 mb-1">
                {% for interface in groups.odd %}
                    <div class="status-box 
                        {% if interface.shutdown == '2' %} bg-gray-500 
                        {% elif interface.status == '1' %} bg-green-500 
                        {% elif interface.status == '2' %} bg-red-500 
                        {% else %} bg-gray-500 {% endif %} 
                        text-white font-bold rounded flex items-center justify-center w-8 h-8" 
                        onclick="openModal('{{ interface.name }}', '{{ interface.vlan }}', '{{ interface.mac }}')">
                        {{ interface.name.split('/')[-1] }} <!-- Only display the interface number -->
                    </div>
                {% endfor %}
            </div>
            <div class="flex space-x-1">
                {% for interface in groups.even %}
                    <div class="status-box 
                        {% if interface.shutdown == '2' %} bg-gray-500 
                        {% elif interface.status == '1' %} bg-green-500 
                        {% elif interface.status == '2' %} bg-red-500 
                        {% else %} bg-gray-500 {% endif %} 
                        text-white font-bold rounded flex items-center justify-center w-8 h-8" 
                        onclick="openModal('{{ interface.name }}', '{{ interface.vlan }}', '{{ interface.mac }}')">
                        {{ interface.name.split('/')[-1] }} <!-- Only display the interface number -->
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endfor %}
</div>

<!-- Modal Structure -->
<div id="interfaceModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden">
    <div class="bg-white dark:bg-gray-800 rounded-lg p-4 max-w-md w-full">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-semibold text-white">Interface Details</h3>
            <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">&times;</button>
        </div>
        <div id="modalContent" class="text-gray-700 dark:text-gray-300">
            <!-- Interface details will be inserted here -->
        </div>
        <div class="flex justify-end mt-4">
            <button onclick="closeModal()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-700">Close</button>
        </div>
    </div>
</div>
</div>
<script>
    function openModal(interfaceName) {
        document.getElementById('modalContent').innerText = interfaceName;
        document.getElementById('interfaceModal').classList.remove('hidden');
    }

    function closeModal() {
        document.getElementById('interfaceModal').classList.add('hidden');
    }

    function toggleViewMode() {
        let switchView = document.getElementById('switch-view');
        if (switchView.classList.contains('grid-cols-4')) {
            switchView.classList.remove('grid-cols-4');
            switchView.classList.add('grid-cols-2');
        } else {
            switchView.classList.remove('grid-cols-2');
            switchView.classList.add('grid-cols-4');
        }
    }
</script>
{% endblock %}
